@*
* Copyright 2021 HM Revenue & Customs
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*@
@import config.ConfigDecorator
@import controllers.auth.requests.UserRequest
@import uk.gov.hmrc.renderer.TemplateRenderer

@import scala.concurrent.ExecutionContext

@this(mainView: MainView)

@(redirectUrl: String, currentTaxYear: String, currentTaxYearMinusOne: String, currentTaxYearMinusTwo: String, isItsa: Boolean, isSa: Boolean, isSeiss: Boolean, taxYear: String, saActionNeeded: SelfAssessmentUserType)(implicit request: UserRequest[_], configDecorator: ConfigDecorator, templateRenderer: TemplateRenderer, messages: play.api.i18n.Messages, ec: ExecutionContext)

@mainView(messages("label.your_self_assessment"), Some(messages("label.your_personal_tax_account"))) {

    <div class="grid-row">
        <div class="column-two-thirds">
            @back_link()

            <h1 class="heading-xlarge no-margin-bottom">@messages("label.your_self_assessment")</h1>

            @if(isItsa) {
                <h2 class="heading-medium">@messages("label.current_tax_year_range", currentTaxYearMinusOne, currentTaxYear)</h2>
                <p>@messages("label.making_tax_digital")</p>
                <p><a class="trackLink" href="@configDecorator.itsaViewUrl">@messages("label.view_and_manage_your_mtd_for_itsa")</a></p>
            }

            @if(isSa) {
                <h2 class="heading-medium">@messages("label.previous_tax_year_range", currentTaxYearMinusTwo, currentTaxYearMinusOne)</h2>
                @saActionNeeded match {
                    case ActivatedOnlineFilerSelfAssessmentUser(saUtr) => {
                        @if(isItsa) {
                            <p><a class="trackLink" href="@routes.InterstitialController.displaySelfAssessment()">@messages("label.view_and_manage_your_earlier_self_assessment_years")</a></p>
                        }
                        @if(!isItsa) {
                            <p><a class="trackLink" href="@routes.InterstitialController.displaySelfAssessment()">@messages("label.view_and_manage_your_earlier_self_assessment_years")</a></p>
                            <li id="complete-tax-return">
                                <a class="ga-track-anchor-click" href="@configDecorator.completeYourTaxReturnUrl(saUtr.toString, taxYear, messages.lang)" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="Complete your tax return">@messages("label.complete_your_tax_return")</a>
                            </li>
                            <li id="make-payment">
                                <a class="ga-track-anchor-click" href="@controllers.routes.PaymentsController.makePayment()" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="Make a payment">@messages("label.make_a_payment")</a>
                            </li>
                            <li id="view-payments">
                                <a class="ga-track-anchor-click" href="@configDecorator.viewSaPaymentsUrl(saUtr.value, messages.lang)" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="View your payments">@messages("label.view_your_payments")</a>
                            </li>
                            <li id="check-if-you-need-tax-return">
                                <a class="ga-track-anchor-click" href="https://www.gov.uk/check-if-you-need-a-tax-return" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="Check if you need to fill in a tax return">@messages("label.check_if_you_need_to_fill_in_a_tax_return")</a>
                            </li>
                        }
                    }
                    case NotYetActivatedOnlineFilerSelfAssessmentUser(saUtr) => {
                        <li>
                            <a class="ga-track-anchor-click" href="@controllers.routes.SelfAssessmentController.handleSelfAssessment()" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="Activate your Self Assessment">@messages("label.activate_your_self_assessment")</a>
                        </li>
                    }
                    case WrongCredentialsSelfAssessmentUser(saUtr) => {
                        <li>
                            <a class="ga-track-anchor-click" href="@controllers.routes.SelfAssessmentController.handleSelfAssessment()" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="Find out how to access Self Assessment">@messages("label.find_out_how_to_access_self_assessment")</a>
                        </li>
                    }
                    case NotEnrolledSelfAssessmentUser(saUtr) => {
                        <li>
                            <a class="ga-track-anchor-click" href="@controllers.routes.SelfAssessmentController.redirectToEnrolForSa()" data-ga-event-category="link - click" data-ga-event-action="Income" data-ga-event-label="Request access to your Self Assessment">@messages("label.not_enrolled.link.text")</a>
                        </li>
                    }
                    case _ => {}
                }
            }

            @if(isSeiss) {
                <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
                <h2 class="heading-medium">@messages("title.seiss")</h2>
                <p><a class="trackLink" href="@configDecorator.seissClaimsUrl">@messages("body.seiss")</a></p>
            }

        </div>
    </div>
}
