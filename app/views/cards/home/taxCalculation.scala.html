@*
 * Copyright 2019 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@(taxCalculationState: TaxCalculationState, previousTaxYear: Int, currentTaxYear: Int)(implicit messages: play.api.i18n.Messages)

@import tags._

@content = @{
  taxCalculationState match {
    case TaxCalculationOverpaidRefundState(amount, startOfTaxYear, endOfTaxYear) => {
      (
        Messages("label.hmrc_owe_you"),
        "%,d".format(amount.toInt),
        Messages("label.find_out_about_your_refund_options"),
        "",
        "",
        ""
      )
    }
    case TaxCalculationOverpaidPaymentProcessingState(amount) => {
      (
        Messages("label.hmrc_owe_you"),
        "%,d".format(amount.toInt),
        Messages("label.hmrc_is_processing_your_refund"),
        "",
        "",
        ""
        )
    }
    case TaxCalculationOverpaidPaymentPaidState(amount, datePaid) => {
      (
        Messages("label.your_refund"),
        "%,d".format(amount.toInt),
        Messages("label.hmrc_has_paid_your_refund_on_a", datePaid.toString),
        "",
        "",
        ""
      )
    }
    case TaxCalculationOverpaidPaymentChequeSentState(amount, datePaid) => {
      (
        Messages("label.your_refund"),
        "%,d".format(amount.toInt),
        Messages("label.hmrc_sent_you_a_cheque_for_a_on_b", "%,d".format(amount.toInt), datePaid.toString),
        "",
        "",
        ""
      )
    }
    case TaxCalculationUnderpaidPaymentDueState(amount, startOfTaxYear, endOfTaxYear, None, None) => {
      (
        Messages("label.you_owe"),
        "%,d".format(amount.toInt),
        Messages("label.you_paid_too_little_tax_there_are_a_number_of_payment_options_available"),
        "",
        "",
        ""
      )
    }
    case TaxCalculationUnderpaidPaymentDueState(amount, startOfTaxYear, endOfTaxYear, Some(dueDate), None) => {
      (
        Messages("label.you_owe"),
        "%,d".format(amount.toInt),
        Messages("label.you_paid_too_little_tax_you_must_pay_by_", dueDate.toString),
        "",
        "",
        ""
      )
    }
    case TaxCalculationUnderpaidPaymentDueState(amount, startOfTaxYear, endOfTaxYear, Some(dueDate), Some(saDeadlineStatus)) => {
      saDeadlineStatus match {
        case SaDeadlineApproachingStatus => {
          (
            Messages("label.you_owe"),
            "%,d".format(amount.toInt),
            Messages("label.you_paid_too_little_tax_you_must_pay_by_", dueDate.toString),
            "",
            "",
            ""
          )
        }
        case SaDeadlinePassedStatus => {
          (
            Messages("label.you_owe"),
            "%,d".format(amount.toInt),
            Messages("label.you_should_have_paid_", dueDate.toString),
            "",
            "",
            ""
          )
        }
      }
    }
    case TaxCalculationUnderpaidPartPaidState(amount, startOfTaxYear, endOfTaxYear, None, None) => {
      (
        Messages("label.you_owe"),
        "%,d".format(amount.toInt),
        Messages("label.you_paid_too_little_tax_there_are_a_number_of_payment_options_available"),
        "",
        "",
        ""
      )
    }
    case TaxCalculationUnderpaidPartPaidState(amount, startOfTaxYear, endOfTaxYear, Some(dueDate), None) => {
      (
        Messages("label.you_owe"),
        "%,d".format(amount.toInt),
        Messages("label.you_paid_too_little_tax_you_must_pay_by_", dueDate.toString),
        "",
        "",
        ""
      )
    }
    case TaxCalculationUnderpaidPartPaidState(amount, startOfTaxYear, endOfTaxYear, Some(dueDate), Some(saDeadlineStatus)) => {
      saDeadlineStatus match {
        case SaDeadlineApproachingStatus => {
          (
            Messages("label.you_owe"),
            "%,d".format(amount.toInt),
            Messages("label.you_paid_too_little_tax_you_must_pay_by_", dueDate.toString),
            "",
            "",
            ""
          )
        }
        case SaDeadlinePassedStatus => {
          (
            Messages("label.you_owe"),
            "%,d".format(amount.toInt),
            Messages("label.you_should_have_paid_", dueDate.toString),
            "",
            "",
            ""
          )
        }
      }
    }
    case TaxCalculationUnderpaidPaidAllState(startOfTaxYear, endOfTaxYear, _) => {
      (
        Messages("label.you_do_not_owe_any_more_tax"),
        "",
        Messages("label.you_have_no_more_payments_to_make_to_HMRC"),
        "",
        "",
        ""
      )
    }
    case TaxCalculationDisabledState(startOfTaxYear, endOfTaxYear) => {
      (
        "",
        "",
        Messages("label.check_to_see_if_you_paid_the_right_amount_of_tax_from_", startOfTaxYear.toString, endOfTaxYear.toString),
        "",
        "",
        ""
      )
    }
    case _ => {
      (
        "",
        "",
        "",
        "",
        "",
        ""
      )
    }
  }
}

@flextile(
  heading = Messages("label.taxcalc_year", previousTaxYear.toString, currentTaxYear.toString),
  subHeading = content._1,
  amount = if(!content._2.isEmpty)Some(content._2) else None,
  bodyContent = content._3
) {
}